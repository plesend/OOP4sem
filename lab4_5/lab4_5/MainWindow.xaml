<Window x:Class="lab4_5.MainWindow"
        Style="{DynamicResource WindowStyle}"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:lab4_5"
        xmlns:svg="http://sharpvectors.codeplex.com/runtime/"
        xmlns:controls="clr-namespace:lab4_5.Controls"
        mc:Ignorable="d"
        Title="Главная"
        Width="1142" Height="670"
        MinWidth="900" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        Icon="D:\лабораторные работы\ооп\lab4_5\Resources\icon.jpg">

    <Window.DataContext>
        <local:MainWindowViewModel />
    </Window.DataContext>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <DataTemplate x:Key="ProductTemplate">
            <Border CornerRadius="8" BorderBrush="LightGray" BorderThickness="1" Margin="0,5,5,0">
                <StackPanel>
                    <Image Source="{Binding ImagePath}"
                           Stretch="Uniform"
                           Height="90"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding Name}"
                               FontWeight="Bold"
                               Margin="10,5,10,0"
                               Height="40"
                               TextAlignment="Right"
                               TextWrapping="Wrap"/>
                    <TextBlock Text="{Binding Description}"
                               Foreground="Gray"
                               Margin="10,5,10,5"
                               TextAlignment="Right"/>
                    <controls:IconButton Text="{Binding Buy}"/>
                    <Button Content="Удалить"
                            Margin="5,1,5,5"
                            Background="Red"
                            Foreground="White"
                            Height="20"
                            BorderThickness="0"
                            Visibility="{Binding DataContext.IsAdmin, RelativeSource={RelativeSource AncestorType=Window}, Converter={StaticResource BoolToVisibilityConverter}}"
                            Command="{Binding DataContext.RemoveProductCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                            CommandParameter="{Binding}" />
                </StackPanel>
            </Border>
        </DataTemplate>
    </Window.Resources>

    <ScrollViewer>
        <Viewbox Stretch="Uniform" StretchDirection="Both">
            <Grid x:Name="MainPage" Width="1142" Height="670" ShowGridLines="False">
                <Grid.RowDefinitions>
                    <RowDefinition Height="54*"/>
                    <RowDefinition Height="125*"/>
                    <RowDefinition Height="77*"/>
                    <RowDefinition Height="0*"/>
                    <RowDefinition Height="39*"/>
                    <RowDefinition Height="250*"/>
                    <RowDefinition Height="125*"/>
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <!-- Навигационные кнопки -->
                <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="163,10,0,0">
                    <Button Style="{DynamicResource BaseButtonStyle}" Width="60" Content="back" Margin="10" Command="{Binding UndoCommand}" />
                    <Button Style="{DynamicResource BaseButtonStyle}" Width="60" Content="frwd" Margin="10" Command="{Binding RedoCommand}"/>
                </StackPanel>

                <!-- Баннер -->
                <controls:Banner Grid.Row="1" Grid.RowSpan="2" Grid.ColumnSpan="7" Loaded="Banner_Loaded" Height="NaN" Margin="0,32,-8,8"/>

                <!-- Кнопки меню -->
                <Button Style="{DynamicResource SpecialButtonStyle}"
                        Content="{DynamicResource ButtonText_Cart}"
                        Command="{Binding ChangeThemeCommand}"
                        Height="40" Width="150"/>

                <Button Style="{DynamicResource BaseButtonStyle}"
                        Content="{DynamicResource ButtonText_Home}"
                        Grid.Column="2" Height="40" Width="150"/>

                <Button Style="{DynamicResource BaseButtonStyle}"
                        Content="{DynamicResource ButtonText_Sales}"
                        Grid.Column="3" Height="40" Width="150"/>

                <Button Style="{DynamicResource BaseButtonStyle}"
                        Content="{DynamicResource ButtonText_AboutUs}"
                        Grid.Column="4" Height="40" Width="150"/>

                <Button Style="{DynamicResource BaseButtonStyle}"
                        x:Name="AddProduct"
                        Content="{DynamicResource ButtonText_Manage}"
                        Grid.Column="5"
                        Command="{Binding AddProductCommand}"
                        Height="40" Width="150"/>

                <Button Style="{DynamicResource BaseButtonStyle}"
                        x:Name="ProfileButton"
                        Content="{DynamicResource ButtonText_Profile}"
                        Grid.Column="6"
                        Command="{Binding OpenProfileCommand}"
                        Height="40" Width="150"/>

                <!-- Поисковая строка -->
                <!--<StackPanel Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="6"
                            Orientation="Horizontal"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Left"
                            Height="30" Margin="116,0,0,0" Width="700">
                    <TextBox Text="{Binding SearchBox, UpdateSourceTrigger=PropertyChanged}"
                             Style="{DynamicResource BaseTextBoxStyle}"
                             Width="650" Height="30" Margin="0,0,10,0" />
                    <Button Style="{DynamicResource BaseButtonStyle}"
                            Content="🔍"
                            Width="40" Height="30"
                            Command="{Binding SearchCommand}" />
                </StackPanel>-->

                <!--<controls:CustomSearchBar Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="6"
                          Margin="116,0,0,0"
                          SearchBox="{Binding SearchBox, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                          SearchCommand="{Binding SearchCommand}" />-->

                <controls:CustomSearchBar Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="6"
                          Margin="116,0,0,0"
                          SearchBox="{Binding SearchBox, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                          SearchCommand="{Binding SearchCommand}"
                          MaxSearchLength="150"
                          SearchPlaceholder="Введите запрос..." />


                <!-- Список товаров -->
                <ScrollViewer Grid.Row="5" Grid.RowSpan="2" Grid.ColumnSpan="7"
                              VerticalScrollBarVisibility="Hidden" Margin="163,12,0,0">
                    <ItemsControl ItemsSource="{Binding Products}"
                                  ItemTemplate="{StaticResource ProductTemplate}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel HorizontalAlignment="Center" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemContainerStyle>
                            <Style TargetType="ContentPresenter">
                                <Setter Property="Height" Value="250" />
                                <Setter Property="Width" Value="150" />
                                <Setter Property="Margin" Value="10" />
                            </Style>
                        </ItemsControl.ItemContainerStyle>
                    </ItemsControl>
                </ScrollViewer>

                <!-- Фильтр -->
                <Border x:Name="SortBorder"
                        Grid.Row="5" Grid.Column="0" Grid.RowSpan="2"
                        BorderBrush="LightGray"
                        BorderThickness="0"
                        Margin="0,12,0,0">
                    <StackPanel>
                        <TextBlock Style="{DynamicResource BaseTextBlockStyle}"
                                   Text="{DynamicResource FilterText}"
                                   FontWeight="Bold" FontSize="16"
                                   Margin="0,5,0,10"
                                   HorizontalAlignment="Center"/>
                        <Line StrokeThickness="1" Stroke="#A578BB"
                              X1="0" Y1="0" X2="120" Y2="0"
                              HorizontalAlignment="Center"/>
                        <TextBlock Style="{DynamicResource BaseTextBlockStyle}"
                                   Text="{DynamicResource PriceText}" Margin="10,10,0,5"/>
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,5" HorizontalAlignment="Center">
                            <TextBox Text="{Binding FromPrice}"
                                     Style="{DynamicResource BaseTextBoxStyle}"
                                     Width="60" Height="25"
                                     Margin="0,0,10,0"
                                     MaxLength="5"/>
                            <TextBox Text="{Binding ToPrice}"
                                     Style="{DynamicResource BaseTextBoxStyle}"
                                     Width="60" Height="25"
                                     MaxLength="5"/>
                        </StackPanel>
                        <TextBlock Style="{DynamicResource BaseTextBlockStyle}"
                                   Text="{DynamicResource BrandText}" Margin="10,10,0,5"/>
                        <ComboBox Text="{Binding Brand}"
                                  SelectedIndex="{Binding SelectedBrandIndex}"
                                  Style="{DynamicResource CmbStyle}"
                                  Height="25" Width="120">
                            <ComboBoxItem Content="Все" IsSelected="True"/>
                            <ComboBoxItem Content="Essence"/>
                            <ComboBoxItem Content="L'OREAL"/>
                            <ComboBoxItem Content="Maybelline"/>
                            <ComboBoxItem Content="NYX"/>
                            <ComboBoxItem Content="Revolution"/>
                        </ComboBox>
                        <Button Style="{DynamicResource SpecialButtonStyle}"
                                x:Name="Adjust"
                                Content="{DynamicResource Adjust}"
                                Width="120" Height="30"
                                Margin="0,20,0,0"
                                Command="{Binding AdjustCommand}"/>
                        <Button Style="{DynamicResource SpecialButtonStyle}"
                                x:Name="Clear"
                                Content="{DynamicResource Clear}"
                                Width="120" Height="30"
                                Margin="0,20,0,0"
                                Command="{Binding ClearCommand}"/>
                        <controls:EventButton HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              IconClick="EventButton_IconClick"/>
                    </StackPanel>
                </Border>

            </Grid>
        </Viewbox>
    </ScrollViewer>
</Window>
